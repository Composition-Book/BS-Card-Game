<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Card Game</title>
  <style>
    /* Styling for game elements */
    .box { width: 200px; height: 100px; border: 2px solid black; margin: 10px; padding: 10px; display: inline-block; vertical-align: top; }
    .deck-box { background-color: lightgray; }
    .player-box { background-color: lightblue; }
    .field-box { background-color: lightgreen; }
    .discard-pile { background-color: lightcoral; }
    .button { padding: 10px 20px; margin: 10px; cursor: pointer; }
    .card { width: 50px; height: 70px; border: 1px solid black; display: inline-block; text-align: center; margin: 5px; cursor: pointer; }
    .hidden { background-color: gray; }
  </style>
</head>
<body>

  <!-- Deck, Player Boxes, Field, Discard Pile -->
  <div class="box deck-box" id="deck-box">
    <p>Deck</p>
    <div id="deck"></div>
  </div>

  <div class="box player-box" id="player1-box">
    <p>Player 1</p>
    <div id="player1-cards"></div>
  </div>
  <div class="box player-box" id="player2-box">
    <p>Player 2</p>
    <div id="player2-cards"></div>
  </div>
  <div class="box player-box" id="player3-box">
    <p>Player 3</p>
    <div id="player3-cards"></div>
  </div>
  <div class="box player-box" id="human-player-box">
    <p>Your Hand</p>
    <div id="human-cards"></div>
  </div>

  <div class="box field-box" id="field-box">
    <p>Field (4 Cards Max)</p>
    <div id="field"></div>
  </div>

  <div class="box discard-pile" id="discard-pile">
    <p>Discard Pile</p>
    <div id="discard"></div>
  </div>

  <!-- Buttons -->
  <button class="button" id="deal-button">Deal Cards</button>
  <button class="button" id="play-button">Play Cards</button>
  <button class="button" id="bs-button">BS!</button>
  <button class="button" id="refresh-button">Refresh</button>

  <p>Current Card: <span id="current-card-counter">A</span></p>
  <p>Discard Total: <span id="discard-total">0</span></p>

  <script>
    // Game data
    const suits = ['♠', '♣', '♦', '♥'];
    const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
    let deck = [];
    let playerCards = { player1: [], player2: [], player3: [], human: [] };
    let discardPile = [];
    let currentCardIndex = 0;

    // Function to create a deck of cards
    function createDeck() {
      deck = [];
      suits.forEach(suit => {
        values.forEach(value => {
          deck.push({ suit, value });
        });
      });
    }

    // Function to shuffle the deck
    function shuffleDeck() {
      for (let i = deck.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [deck[i], deck[j]] = [deck[j], deck[i]];
      }
    }

    // Function to deal cards to players
    function dealCards() {
      createDeck();
      shuffleDeck();

      // Split deck into 4 parts
      let currentPlayer = 0;
      while (deck.length) {
        const card = deck.pop();
        const player = currentPlayer === 0 ? 'human' : `player${currentPlayer}`;
        playerCards[player].push(card);
        currentPlayer = (currentPlayer + 1) % 4;
      }

      renderCards();
    }

    // Function to render cards in player boxes
    function renderCards() {
      const humanBox = document.getElementById('human-cards');
      humanBox.innerHTML = '';
      playerCards.human.forEach(card => {
        humanBox.appendChild(createCardElement(card));
      });

      ['player1', 'player2', 'player3'].forEach(player => {
        const box = document.getElementById(`${player}-cards`);
        box.innerHTML = '';
        playerCards[player].forEach(card => {
          box.appendChild(createCardElement(card));
        });
      });

      document.getElementById('deck').innerHTML = ''; // Deck is hidden now
    }

    // Function to create a card element
    function createCardElement(card) {
      const cardDiv = document.createElement('div');
      cardDiv.classList.add('card');
      cardDiv.textContent = `${card.value} ${card.suit}`;
      cardDiv.draggable = true;
      cardDiv.addEventListener('dragstart', handleDragStart);
      cardDiv.addEventListener('dragend', handleDragEnd);
      return cardDiv;
    }

    // Function to handle drag start
    function handleDragStart(e) {
      e.dataTransfer.setData('text', e.target.textContent);
    }

    // Function to handle drag end
    function handleDragEnd() {}

    // Function to handle card drop
    function handleDrop(e) {
      e.preventDefault();
      const cardText = e.dataTransfer.getData('text');
      const [value, suit] = cardText.split(' ');

      if (e.target.id === 'field-box' && document.getElementById('field').childElementCount < 4) {
        const card = { value, suit };
        discardPile.push(card);
        renderDiscardPile();
        renderCards();
      }
    }

    // Function to render discard pile
    function renderDiscardPile() {
      const discardBox = document.getElementById('discard');
      discardBox.innerHTML = '';
      discardPile.forEach(card => {
        const cardDiv = createCardElement(card);
        cardDiv.classList.add('hidden'); // Cards in discard pile are hidden
        discardBox.appendChild(cardDiv);
      });
      document.getElementById('discard-total').textContent = discardPile.length;
    }

    // Function to handle BS! call
    function handleBS() {
      const isLie = Math.random() > 0.5; // Random for demo purposes
      if (isLie) {
        // Move all discard pile cards to computer's hand (simulating a lie)
        playerCards.player1.push(...discardPile);
      } else {
        // Move all discard pile cards to human player hand
        playerCards.human.push(...discardPile);
      }
      discardPile = []; // Clear discard pile
      renderCards();
      renderDiscardPile();
    }

    // Function to handle refresh
    function refreshGame() {
      location.reload();
    }

    // Event Listeners for buttons
    document.getElementById('deal-button').addEventListener('click', dealCards);
    document.getElementById('play-button').addEventListener('click', renderDiscardPile);
    document.getElementById('bs-button').addEventListener('click', handleBS);
    document.getElementById('refresh-button').addEventListener('click', refreshGame);

    // Initial setup
    renderCards();

  </script>
</body>
</html>
